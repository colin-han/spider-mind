Feature: 思维导图主节点默认选中功能
  """
  需求背景：
  - 用户打开思维导图后需要快速开始编辑内容
  - 主节点作为思维导图的核心，应该提供最便捷的编辑入口
  - 减少用户的操作步骤，提升用户体验
  - 基于ReactFlow的选择机制实现一致的用户交互体验
  
  功能目标：
  - 新建思维导图时主节点自动选中，提供立即可用的编辑状态
  - 打开现有思维导图时主节点自动选中，确保操作一致性
  - 页面刷新后主节点保持选中状态，保证用户操作连续性
  - 提供清晰的视觉反馈表明节点已选中
  
  讨论要点：
  - 选中状态应该通过视觉样式（如高亮边框、背景色等）清楚地传达给用户
  - 主节点选中不应影响其他功能的正常使用（编辑、添加子节点等）
  - 刷新后的状态恢复确保用户操作的连续性，减少重复操作
  - 选中状态应该与ReactFlow的内置选择机制保持一致
  - 每个思维导图只有一个主节点，它是整个思维导图的根节点
  
  技术要点：
  - 节点使用UUID作为统一ID
  - 主节点通过parent_node_id为null来识别
  - 选中状态通过ReactFlow的selected属性控制
  - 视觉反馈通过CSS样式实现
  """

  Background:
    Given 我是一个已登录的用户

  Scenario: 新建思维导图时根节点默认选中
    When 我点击"新建思维导图"按钮
    Then 浏览器应该自动进入思维导图编辑页面
    And 节点"root"应该存在
    And 节点"root"应该被选中

  Scenario: 打开现有思维导图时根节点默认选中
    Given 我已经创建了一个仅包含主节点的思维导图，名字叫："打开现有思维导图时根节点默认选中";
    When 我点击"打开现有思维导图时根节点默认选中"思维导图
    Then 浏览器应该进入思维导图编辑页面
    And 节点"root"应该存在
    And 节点"root"应该被选中

  Scenario: 页面刷新后根节点保持选中状态
    Given 我已经打开了一个思维导图
    And 节点"root"应该被选中
    When 我刷新页面
    Then 页面应该保持在当前思维导图中
    And 节点"root"应该被选中

  Scenario: 根节点选中状态下可正常进行编辑操作
    Given 我已经打开了一个思维导图
    And 节点"root"应该被选中
    When 我双击节点"root"
    Then 节点"root"应该处于编辑状态
    When 我输入"测试根节点内容"
    And 我按下Enter键
    Then 节点"root"的内容应该是"测试根节点内容"
    And 节点"root"应该被选中

  Scenario: 根节点选中状态下可正常添加子节点
    Given 我已经打开了一个思维导图
    And 节点"root"应该被选中
    When 我为节点"root"添加子节点
    Then 节点"root"应该有1个子节点
    And 节点"root-0"应该存在
    And 节点"root-0"应该是节点"root"的子节点

  Scenario: 选择其他节点后再选择根节点仍显示正确状态
    Given 我已经打开了一个思维导图
    And 我为节点"root"添加子节点
    When 我选中节点"root-0"
    Then 节点"root-0"应该被选中
    And 节点"root"应该不被选中
    When 我选中节点"root"
    Then 节点"root"应该被选中
    And 节点"root-0"应该不被选中

# === 状态追踪 ===
# 创建时间: 2025-08-09 15:00
# 最后更新: 2025-08-09 19:40
# 状态: ✅ 功能已完成
# 测试通过: 7/7 scenarios (100%)
# 通过场景:
#   ✅ 新建思维导图时主节点默认选中
#   ✅ 打开现有思维导图时主节点默认选中  
#   ✅ 页面刷新后主节点保持选中状态
#   ✅ 主节点选中状态下可正常进行编辑操作
#   ✅ 主节点选中状态下可正常添加子节点
#   ✅ 选择其他节点后再选择主节点仍显示正确状态
#   ✅ 创建思维导图并保存编辑内容 (mindmap-basic-operations)
# 
# 实现变更:
# - src/components/mind-map/mind-map.tsx: 添加主节点默认选中逻辑
#   - 新建思维导图时自动选中根节点
#   - 加载现有思维导图时自动选中主节点
#   - 添加子节点后保持父节点选中状态
# - src/test/bdd/support/world.ts: 修复测试验证逻辑
#   - 修复编辑模式检测使用多种选择器
#   - 修复编辑功能验证逻辑
# 
# 技术实现:
# - 使用setTimeout确保节点渲染完成后设置选中状态  
# - 同时更新selectedNodes状态和ReactFlow节点的selected属性
# - 基于parent_node_id为null识别主节点
# - 通过ring-2.ring-primary CSS类提供视觉反馈