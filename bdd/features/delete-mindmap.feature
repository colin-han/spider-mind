Feature: 删除思维导图功能
  """
  需求背景：
  - 用户在思维导图管理页面可以删除不再需要的思维导图
  - 删除操作需要用户明确确认，防止误删
  - 删除操作会同时删除思维导图及其所有相关节点数据
  - 只有思维导图的创建者可以删除该思维导图

  功能目标：
  - 提供安全可靠的思维导图删除功能
  - 确保数据完整性和用户权限控制
  - 提供良好的用户体验和错误处理

  讨论要点：
  - 删除操作采用二次确认机制，防止误操作
  - 删除时会清理思维导图主表和节点表的相关数据
  - 删除后界面实时更新，移除已删除的思维导图卡片
  - 网络错误时提供友好的错误提示
  - 删除按钮采用悬停显示机制，防止误触
  """

  Background:
    Given 用户已经登录系统
    And 用户在思维导图管理页面

  Scenario: 成功删除思维导图
    Given 我已经创建了一个仅包含主节点的思维导图，名字叫："项目规划"
    When 我点击"项目规划"思维导图卡片上的删除按钮
    Then 系统显示删除确认对话框
    And 对话框标题为"删除思维导图"
    And 对话框内容包含"确定要删除思维导图 \"项目规划\" 吗？此操作不可撤销。"
    When 我点击确认对话框中的"确认"按钮
    Then 系统发送DELETE请求到"/api/mindmaps/{思维导图ID}"
    And 思维导图列表中不再显示名为"项目规划"的卡片
    And 页面底部统计信息更新为新的数量
    And 删除确认对话框关闭
    When 我刷新页面
    Then 思维导图列表中不再显示名为"项目规划"的卡片

  Scenario: 取消删除操作
    Given 我已经创建了一个仅包含主节点的思维导图，名字叫："学习计划"
    When 我点击"学习计划"思维导图卡片上的删除按钮
    Then 系统显示删除确认对话框
    When 我点击确认对话框中的"取消"按钮
    Then 删除确认对话框关闭
    And "学习计划"思维导图仍然显示在列表中
    When 我刷新页面
    Then "学习计划"思维导图仍然显示在列表中

  Scenario: 点击对话框外部区域不会取消删除
    Given 我已经创建了一个仅包含主节点的思维导图，名字叫："工作笔记"
    When 我点击"工作笔记"思维导图卡片上的删除按钮
    Then 系统显示删除确认对话框
    When 我点击对话框外部区域
    Then 删除确认对话框仍然存在
    And "工作笔记"思维导图仍然显示在列表中

  Scenario: 使用ESC键取消删除操作
    Given 我已经创建了一个仅包含主节点的思维导图，名字叫："读书笔记"
    When 我点击"读书笔记"思维导图卡片上的删除按钮
    Then 系统显示删除确认对话框
    When 我按下ESC键
    Then 删除确认对话框关闭
    And "读书笔记"思维导图仍然显示在列表中

  Scenario: 删除不存在的思维导图
    Given 我已经创建了一个仅包含主节点的思维导图，名字叫："临时笔记"
    And 该思维导图已被其他方式删除
    When 我点击"临时笔记"思维导图卡片上的删除按钮
    And 我点击确认对话框中的"确认"按钮
    Then 系统显示错误提示"删除失败: 思维导图不存在"
    And 思维导图列表刷新移除不存在的条目

  Scenario: 防止删除按钮误触
    Given 我已经创建了一个仅包含主节点的思维导图，名字叫："重要文档"
    When 我鼠标悬停在思维导图卡片上
    Then 删除按钮从不可见变为可见
    When 我鼠标移出思维导图卡片
    Then 删除按钮恢复为不可见状态
    When 我点击思维导图卡片内容区域（非删除按钮）
    Then 用户导航到思维导图编辑页面
    And 没有触发删除操作

# === 状态追踪 ===
# 创建时间: 2025-01-27 12:00
# Step实现时间: 2025-01-27 16:00
# 功能实现时间: 2025-08-09 19:40
# 最后更新: 2025-08-09 19:40
# 状态: 已完成（主要功能实现）
# 已实现Steps: 30/30
# 测试通过: 核心功能全部通过
# 
# 实现的功能：
# ✅ 删除确认对话框显示和交互
# ✅ ESC键取消删除操作
# ✅ 删除按钮悬停状态切换（opacity检测）
# ✅ 点击外部区域不会关闭对话框
# ✅ 核心删除功能和API调用
# ✅ 删除API增强（检查思维导图存在性）
# ✅ 错误提示UI组件和显示逻辑
# 
# 技术改进：
# - AlertDialog组件增加ESC键支持和可配置外部点击行为
# - 删除API实现真正的存在性检查和错误处理
# - 思维导图页面增加错误提示状态管理和UI显示
# - BDD测试选择器优化，支持data-testid和opacity检测
# 
# 备注: 删除思维导图功能的核心业务逻辑已完全实现并通过测试